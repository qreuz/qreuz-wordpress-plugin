"use strict";(self.webpackChunkqreuz_wordpress_plugin=self.webpackChunkqreuz_wordpress_plugin||[]).push([[844],{9426:function(e,t,n){n.d(t,{Z:function(){return a.Z}});var a=n(7595)},7595:function(e,t,n){n.d(t,{Z:function(){return s}});const{render:a,useState:r}=wp.element;function s(e,t,n,a){const r={action:e,qreuz_current_time:(new Date).toLocaleTimeString(),_wpnonce:qreuzEnv._wpnonce,_wp_http_referer:qreuzEnv._wp_http_referer,form:t};return void 0!==a&&(r.data=JSON.stringify(a)),async function(){var e=[];for(var t in r){var n=encodeURIComponent(t),a=encodeURIComponent(r[t]);e.push(n+"="+a)}e=e.join("&");const s=await fetch(qreuzEnv._wp_ajax_url,{method:"POST",body:e,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then((e=>{if(e.ok)return e.json();throw new Error("Server response was not OK")})).then((e=>e));return null!=s?s:'{"success": false, "msg": "response undefined"}'}()}},4865:function(e,t,n){n.d(t,{Q0:function(){return a},An:function(){return r}});const a=React.createContext(),r=React.createContext()},1844:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var a=n(9307),r=n(9426),s=n(4865);const u={contextLoading:!0,localContextLoading:!0,open:!1,user:!1,userPlan:!1,authKey:!1,authParam:!1,userEmail:!1,isPropertyActive:!0,justLoggedIn:!1,message:void 0},o="SET_CONTEXT_LOADING",c="SET_LOCAL_CONTEXT_LOADING",i="SET_OPEN",l="SET_USER",_="SET_USER_PLAN",d="SET_AUTH_KEY",p="SET_AUTH_PARAM",v="SET_USER_EMAIL",g="SET_IS_PROPERTY_ACTIVE",E="SET_JUST_LOGGED_IN",h="SET_MESSAGE";function y(e,t){switch(t.type){case o:return{...e,contextLoading:t.value};case c:return{...e,localContextLoading:t.value};case i:return{...e,open:t.value};case l:return{...e,user:t.value};case _:return{...e,userPlan:t.value};case d:return{...e,authKey:t.value};case p:return{...e,authParam:t.value};case v:return{...e,userEmail:t.value};case g:return{...e,isPropertyActive:t.value};case E:return{...e,justLoggedIn:t.value};case h:return{...e,message:t.value};default:return e}}function f(e,t){let{children:n}=e;const[f,L]=React.useReducer(y,u),m={contextLoading:f.contextLoading,localContextLoading:f.localContextLoading,open:f.open,user:f.user,userPlan:f.userPlan,authKey:f.authKey,authParam:f.authParam,userEmail:f.userEmail,isPropertyActive:f.isPropertyActive,justLoggedIn:f.justLoggedIn,message:f.message,setContextLoading:e=>{L({type:o,value:e})},setLocalContextLoading:e=>{L({type:c,value:e})},setOpen:e=>{L({type:i,value:e})},setUser:e=>{L({type:l,value:e})},setUserPlan:e=>{L({type:_,value:e})},setAuthKey:e=>{L({type:d,value:e})},setAuthParam:e=>{L({type:p,value:e})},setUserEmail:e=>{L({type:v,value:e})},setIsPropertyActive:e=>{L({type:g,value:e})},setJustLoggedIn:e=>{L({type:E,value:e})},setMessage:e=>{L({type:h,value:e})}},w=async()=>{try{const a=await(0,r.Z)("qreuz_get_user_data","wp_plugin_generic_provider_data",t);if(!0!==a.user){m.setUser(!1);var e=(n=new RegExp("[\\?&]auth=([^&#]*)").exec(window.location.href))&&n[1]||void 0;e>""?(async()=>{try{const n={auth_key:e},a=await(0,r.Z)("qreuz_getstarted","wp_plugin_check_auth_key",t,n);!0===a.success?(m.setAuthKey(!0),m.setAuthParam(e),m.setUserEmail(a.email)):m.setAuthKey(!1),m.setContextLoading(!1)}catch(e){console.log(e)}})():(m.setContextLoading(!1),m.setAuthKey(!1))}else m.setContextLoading(!1),m.setUser(!0),m.setUserPlan(a.user_data.plan.active),m.setIsPropertyActive(a.user_data.is_active),m.setMessage(a.user_data.is_active?"active":"pending")}catch(e){console.log(e)}var n};return React.useEffect((()=>{w()}),[]),React.useEffect((()=>{w(),m.setJustLoggedIn(!1)}),[m.justLoggedIn]),(0,a.createElement)(s.Q0.Provider,{value:m},n)}}}]);